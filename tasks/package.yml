- block:
    - name: Add PPA for Ubuntu
      ansible.builtin.apt_repository:
        repo: ppa:neovim-ppa/stable
        state: present
      when: nvim_ppa | bool is true

    - name: Install with apt
      apt:
        name: neovim
        state: latest
      become: true
      when: nvim_version | string == "latest"
    
    - name: "Install version: {{ nvim_version }}"
      apt:
        name: "neovim={{ nvim_version }}"
        state: present
      become: true
      when: nvim_version | string != "latest"
  when: ansible_os_family == "Debian"

- block:
    - name: Nvim deps
      yum:
        name:
          - epel-release
        state: present
      become: true
    
    - name: Install with yum
      yum:
        name: neovim
        state: latest
      become: true
      when: nvim_version | string == "latest"
    
    - name: "Install version: {{ nvim_version }}"
      yum:
        name: "neovim-{{ nvim_version }}"
        state: present
      become: true
      when: nvim_version | string != "latest"
  when: ansible_os_family == "RedHat"
